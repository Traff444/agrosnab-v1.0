# Owner Bot ‚Äî –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–∫–ª–∞–¥–æ–º

Telegram-–±–æ—Ç –¥–ª—è –≤–ª–∞–¥–µ–ª—å—Ü–∞ –º–∞–≥–∞–∑–∏–Ω–∞: –ø—Ä–∏—ë–º —Ç–æ–≤–∞—Ä–æ–≤, —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–∞—Ç–∞–ª–æ–≥–æ–º, –∑–∞–≥—Ä—É–∑–∫–∞ —Ñ–æ—Ç–æ.

**–ë–æ—Ç:** [@tophitboss_bot](https://t.me/tophitboss_bot) ‚Äî "–£–ø—Ä–∞–≤–ª—è—é—â–∏–π –º–∞–≥–∞–∑–∏–Ω–∞"

## –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

| –§—É–Ω–∫—Ü–∏—è | –°—Ç–∞—Ç—É—Å | –û–ø–∏—Å–∞–Ω–∏–µ |
|---------|--------|----------|
| –ü—Ä–∏—Ö–æ–¥ —Ç–æ–≤–∞—Ä–∞ | ‚úÖ | –ë—ã—Å—Ç—Ä—ã–π –ø–∞—Ä—Å–∏–Ω–≥ "–ù–∞–∑–≤–∞–Ω–∏–µ –¶–µ–Ω–∞ –ö–æ–ª-–≤–æ" |
| –ü–æ–∏—Å–∫ —Ç–æ–≤–∞—Ä–æ–≤ | ‚úÖ | –ü–æ SKU –∏–ª–∏ –Ω–∞–∑–≤–∞–Ω–∏—é |
| –°–æ–∑–¥–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–æ–≤ | ‚úÖ | –° –≥–µ–Ω–µ—Ä–∞—Ü–∏–µ–π SKU |
| –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –æ—Å—Ç–∞—Ç–∫–æ–≤ | ‚úÖ | –ü—Ä–∏—Ö–æ–¥ —Å –∏—Å—Ç–æ—Ä–∏–µ–π |
| –ó–∞–≥—Ä—É–∑–∫–∞ —Ñ–æ—Ç–æ | ‚úÖ | –í Google Drive |
| –ê–Ω–∞–ª–∏–∑ –∫–∞—á–µ—Å—Ç–≤–∞ —Ñ–æ—Ç–æ | ‚úÖ | –†–∞–∑–º–µ—Ä, —Ä–µ–∑–∫–æ—Å—Ç—å, —è—Ä–∫–æ—Å—Ç—å |
| –£–ª—É—á—à–µ–Ω–∏–µ —Ñ–æ—Ç–æ | ‚úÖ | –î–µ–Ω–æ–π–∑–∏–Ω–≥, –æ–±—Ä–µ–∑–∫–∞ |
| –ê–∫—Ç–∏–≤–∞—Ü–∏—è/–¥–µ–∞–∫—Ç–∏–≤–∞—Ü–∏—è | ‚úÖ | –° –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ–º |
| –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ —Å–∏—Å—Ç–µ–º—ã | ‚úÖ | –ü—Ä–æ–≤–µ—Ä–∫–∞ Sheets –∏ Drive |
| –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ (Sentry) | ‚úÖ | –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –æ—à–∏–±–æ–∫ –≤ production |
| Telegram –∞–ª–µ—Ä—Ç—ã | ‚úÖ | –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –≤–ª–∞–¥–µ–ª—å—Ü—É –æ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –æ—à–∏–±–∫–∞—Ö |
| Retry –ª–æ–≥–∏–∫–∞ | ‚úÖ | –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –ø–æ–≤—Ç–æ—Ä—ã –ø—Ä–∏ —Å–±–æ—è—Ö Google API |

## –ö–æ–º–∞–Ω–¥—ã

| –ö–æ–º–∞–Ω–¥–∞ | –û–ø–∏—Å–∞–Ω–∏–µ |
|---------|----------|
| `/start` | –ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é |
| `/health` | –ë—ã—Å—Ç—Ä–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å–∏—Å—Ç–µ–º—ã |
| `/cleanup` | –û—á–∏—Å—Ç–∫–∞ –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤ |

## –ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é

| –ö–Ω–æ–ø–∫–∞ | –§—É–Ω–∫—Ü–∏—è |
|--------|---------|
| üì¶ –ü—Ä–∏—Ö–æ–¥ —Ç–æ–≤–∞—Ä–∞ | –î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—ã–π —Ç–æ–≤–∞—Ä –∏–ª–∏ –ø–æ–ø–æ–ª–Ω–∏—Ç—å –æ—Å—Ç–∞—Ç–æ–∫ |
| üìä –°–∫–ª–∞–¥ | –ü—Ä–æ—Å–º–æ—Ç—Ä –≤—Å–µ—Ö —Ç–æ–≤–∞—Ä–æ–≤ —Å–ø–∏—Å–∫–æ–º —Å –ø–∞–≥–∏–Ω–∞—Ü–∏–µ–π |
| üîç –ù–∞–π—Ç–∏ —Ç–æ–≤–∞—Ä | –ü–æ–∏—Å–∫ –ø–æ SKU –∏–ª–∏ –Ω–∞–∑–≤–∞–Ω–∏—é |
| üìã –ó–∞–∫–∞–∑—ã —Å–µ–≥–æ–¥–Ω—è | –°–≤–æ–¥–∫–∞ –∑–∞–∫–∞–∑–æ–≤ (–≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ) |
| üìä CRM | –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–ª–∏–µ–Ω—Ç–∞–º–∏, –≤–æ—Ä–æ–Ω–∫–∞ –ø—Ä–æ–¥–∞–∂ |
| üîß –°—Ç–∞—Ç—É—Å | –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–π |

## –ü—Ä–∏—Ö–æ–¥ —Ç–æ–≤–∞—Ä–∞

### –ë—ã—Å—Ç—Ä—ã–π –≤–≤–æ–¥

–í–≤–µ–¥–∏—Ç–µ –¥–∞–Ω–Ω—ã–µ –æ–¥–Ω–∏–º —Å–æ–æ–±—â–µ–Ω–∏–µ–º:

```
–ù–∞–∑–≤–∞–Ω–∏–µ –¶–µ–Ω–∞ –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ
```

–ü—Ä–∏–º–µ—Ä—ã:
- `–ú–∞—Ö–æ—Ä–∫–∞ –°–°–°–† 500 10` ‚Üí –Ω–∞–∑–≤–∞–Ω–∏–µ, —Ü–µ–Ω–∞ 500‚ÇΩ, 10 —à—Ç.
- `–ö–æ—Ñ–µ –ê—Ä–∞–±–∏–∫–∞ 1200—Ä 25—à—Ç` ‚Üí —Å —Å—É—Ñ—Ñ–∏–∫—Å–∞–º–∏

### –ü—Ä–æ—Ü–µ—Å—Å

```
1. –í–≤–æ–¥ –¥–∞–Ω–Ω—ã—Ö
   ‚îî‚îÄ –ë—ã—Å—Ç—Ä–∞—è —Å—Ç—Ä–æ–∫–∞ –∏–ª–∏ –ø–æ—à–∞–≥–æ–≤—ã–π –≤–≤–æ–¥

2. –ü–æ–∏—Å–∫ –ø–æ—Ö–æ–∂–∏—Ö —Ç–æ–≤–∞—Ä–æ–≤
   ‚îî‚îÄ –í—ã–±—Ä–∞—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π –∏–ª–∏ —Å–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π

3. –§–æ—Ç–æ —Ç–æ–≤–∞—Ä–∞
   ‚îú‚îÄ –ó–∞–≥—Ä—É–∑–∏—Ç—å –Ω–æ–≤–æ–µ
   ‚îú‚îÄ –û—Å—Ç–∞–≤–∏—Ç—å —Ç–µ–∫—É—â–µ–µ
   ‚îî‚îÄ –ü—Ä–æ–ø—É—Å—Ç–∏—Ç—å

4. –ê–Ω–∞–ª–∏–∑ –∫–∞—á–µ—Å—Ç–≤–∞ —Ñ–æ—Ç–æ
   ‚îú‚îÄ –ü—Ä–∏–Ω—è—Ç—å
   ‚îú‚îÄ –£–ª—É—á—à–∏—Ç—å (–¥–µ–Ω–æ–π–∑–∏–Ω–≥, –æ–±—Ä–µ–∑–∫–∞)
   ‚îî‚îÄ –ü–µ—Ä–µ—Å–Ω—è—Ç—å

5. –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ
   ‚îî‚îÄ –ó–∞–ø–∏—Å—å –≤ Google Sheets + –∑–∞–≥—Ä—É–∑–∫–∞ –≤ Drive
```

## –ü—Ä–æ—Å–º–æ—Ç—Ä —Å–∫–ª–∞–¥–∞

–ö–Ω–æ–ø–∫–∞ **üìä –°–∫–ª–∞–¥** –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç –ø–æ—Å—Ç—Ä–∞–Ω–∏—á–Ω—ã–π —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö —Ç–æ–≤–∞—Ä–æ–≤:
- 8 —Ç–æ–≤–∞—Ä–æ–≤ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É
- –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞: –∞–∫—Ç–∏–≤–Ω—ã–µ –≤–≤–µ—Ä—Ö—É, –∑–∞—Ç–µ–º –ø–æ –Ω–∞–∑–≤–∞–Ω–∏—é
- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞: –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∞–∫—Ç–∏–≤–Ω—ã—Ö, –æ–±—â–∏–π –æ—Å—Ç–∞—Ç–æ–∫
- –ö–ª–∏–∫ –ø–æ —Ç–æ–≤–∞—Ä—É ‚Üí –∫–∞—Ä—Ç–æ—á–∫–∞ —Å –¥–µ–π—Å—Ç–≤–∏—è–º–∏

## –û–ø–µ—Ä–∞—Ü–∏–∏ —Å —Ç–æ–≤–∞—Ä–∞–º–∏

–ü—Ä–∏ –≤—ã–±–æ—Ä–µ —Ç–æ–≤–∞—Ä–∞ (–∏–∑ –ø–æ–∏—Å–∫–∞ –∏–ª–∏ —Å–ø–∏—Å–∫–∞ —Å–∫–ª–∞–¥–∞) –¥–æ—Å—Ç—É–ø–Ω—ã —Å–ª–µ–¥—É—é—â–∏–µ –¥–µ–π—Å—Ç–≤–∏—è:

| –ö–Ω–æ–ø–∫–∞ | –î–µ–π—Å—Ç–≤–∏–µ |
|--------|----------|
| üì¶ –ü—Ä–∏—Ö–æ–¥ | –î–æ–±–∞–≤–∏—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫ –æ—Å—Ç–∞—Ç–∫—É |
| ‚ûñ –°–ø–∏—Å–∞—Ç—å | –£–º–µ–Ω—å—à–∏—Ç—å –æ—Å—Ç–∞—Ç–æ–∫ —Å —É–∫–∞–∑–∞–Ω–∏–µ–º –ø—Ä–∏—á–∏–Ω—ã |
| üßÆ –ö–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∫–∞ | –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–∏–π –æ—Å—Ç–∞—Ç–æ–∫ |
| üì∑ –§–æ—Ç–æ | –ó–∞–º–µ–Ω–∏—Ç—å —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏—é —Ç–æ–≤–∞—Ä–∞ |
| üóëÔ∏è –ê—Ä—Ö–∏–≤ | –î–µ–∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å —Ç–æ–≤–∞—Ä (—Å –æ–ø—Ü–∏–µ–π –æ–±–Ω—É–ª–µ–Ω–∏—è) |

### –°–ø–∏—Å–∞–Ω–∏–µ

–ü—Ä–∏—á–∏–Ω—ã —Å–ø–∏—Å–∞–Ω–∏—è:
- üóëÔ∏è –ü–æ—Ä—á–∞ ‚Äî –∏—Å–ø–æ—Ä—á–µ–Ω–Ω—ã–π —Ç–æ–≤–∞—Ä
- üéÅ –ü–æ–¥–∞—Ä–æ–∫ ‚Äî –æ—Ç–¥–∞–Ω –≤ –ø–æ–¥–∞—Ä–æ–∫
- üîÑ –ü–µ—Ä–µ—Å–æ—Ä—Ç ‚Äî –ø–µ—Ä–µ—Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞
- üìù –î—Ä—É–≥–æ–µ ‚Äî —Å–≤–æ—è –ø—Ä–∏—á–∏–Ω–∞

–ú–æ–∂–Ω–æ —É–∫–∞–∑–∞—Ç—å –ø—Ä–∏—á–∏–Ω—É —Å—Ä–∞–∑—É: `5 –ø–æ—Ä—á–∞` ‚Äî —Å–ø–∏—Å–∞—Ç—å 5 —à—Ç. –ø–æ –ø—Ä–∏—á–∏–Ω–µ "–ø–æ—Ä—á–∞".

### –ö–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∫–∞

–ü—Ä–∏—á–∏–Ω—ã –∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∫–∏:
- üìã –ò–Ω–≤–µ–Ω—Ç–∞—Ä–∏–∑–∞—Ü–∏—è ‚Äî –ø–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º –ø–µ—Ä–µ—Å—á—ë—Ç–∞
- üîÑ –ü–µ—Ä–µ—Å–æ—Ä—Ç ‚Äî –ø–µ—Ä–µ—Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ —Ç–æ–≤–∞—Ä–æ–≤
- ‚ö†Ô∏è –û—à–∏–±–∫–∏ —É—á—ë—Ç–∞ ‚Äî –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ—à–∏–±–æ–∫
- üìù –î—Ä—É–≥–æ–µ ‚Äî —Å–≤–æ—è –ø—Ä–∏—á–∏–Ω–∞

### –ê—Ä—Ö–∏–≤–∞—Ü–∏—è

–î–≤–∞ —Ä–µ–∂–∏–º–∞:
1. **–ê—Ä—Ö–∏–≤–∏—Ä–æ–≤–∞—Ç—å** ‚Äî —Å–∫—Ä—ã—Ç—å –∏–∑ –∫–∞—Ç–∞–ª–æ–≥–∞, –æ—Å—Ç–∞—Ç–æ–∫ –Ω–µ –º–µ–Ω—è–µ—Ç—Å—è
2. **–û–±–Ω—É–ª–∏—Ç—å –∏ –∞—Ä—Ö–∏–≤–∏—Ä–æ–≤–∞—Ç—å** ‚Äî —Å–ø–∏—Å–∞—Ç—å –æ—Å—Ç–∞–≤—à–∏–π—Å—è –æ—Å—Ç–∞—Ç–æ–∫ –∏ —Å–∫—Ä—ã—Ç—å

## –£—Å—Ç–∞–Ω–æ–≤–∫–∞

### –õ–æ–∫–∞–ª—å–Ω–æ

```bash
cd owner_bot
cp .env.example .env
# –ó–∞–ø–æ–ª–Ω–∏—Ç–µ .env

# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
uv venv && source .venv/bin/activate
uv pip install -e .

# –ó–∞–ø—É—Å–∫
python -m app.main
```

### Docker

```bash
cd owner_bot
cp .env.example .env
# –ó–∞–ø–æ–ª–Ω–∏—Ç–µ .env

# –°–æ–∑–¥–∞–π—Ç–µ –ø–∞–ø–∫—É secrets –≤ –∫–æ—Ä–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞ (–µ—Å–ª–∏ –Ω–µ —Å–æ–∑–¥–∞–Ω–∞)
mkdir -p ../secrets
cp /path/to/your-service-account.json ../secrets/

docker compose up --build
```

#### Docker Volumes

```yaml
services:
  owner-bot:
    volumes:
      - ./tmp:/app/tmp           # –í—Ä–µ–º–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã (—Ñ–æ—Ç–æ)
      - ./data:/app/data         # –ü–æ—Å—Ç–æ—è–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
      - ../secrets:/app/secrets  # Google Service Account JSON
```

| Volume | –•–æ—Å—Ç | –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ |
|--------|------|-----------|------------|
| tmp | `./tmp` | `/app/tmp` | –í—Ä–µ–º–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã (–∞–≤—Ç–æ–æ—á–∏—Å—Ç–∫–∞) |
| data | `./data` | `/app/data` | –ü–µ—Ä—Å–∏—Å—Ç–µ–Ω—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ |
| secrets | `../secrets` | `/app/secrets` | Google credentials |

**–í–∞–∂–Ω–æ:** –ü—É—Ç—å –∫ credentials –≤ `.env` –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–Ω—ã–º:
```bash
# –ü—Ä–∞–≤–∏–ª—å–Ω–æ (–≤–Ω—É—Ç—Ä–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞)
GOOGLE_SERVICE_ACCOUNT_JSON_PATH=/app/secrets/your-service-account.json

# –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ (–ª–æ–∫–∞–ª—å–Ω—ã–π –ø—É—Ç—å)
# GOOGLE_SERVICE_ACCOUNT_JSON_PATH=/Users/me/project/secrets/...
```

## –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è (.env)

```bash
# Telegram Bot
# –ü–æ–ª—É—á–∏—Ç—å —Ç–æ–∫–µ–Ω: @BotFather ‚Üí /newbot
# –ë–æ—Ç: @tophitboss_bot (https://t.me/tophitboss_bot)
TELEGRAM_BOT_TOKEN=8015984812:AAXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
OWNER_TELEGRAM_IDS=481890  # –ß–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é –¥–ª—è –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö

# Google Sheets
GOOGLE_SHEETS_ID=1r9rpm7WF1tAjPud8DhpgszpPQNVhfforh1XXyKNuR9A

# Google Service Account (–æ–¥–∏–Ω –∏–∑ –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤)
# –í–∞—Ä–∏–∞–Ω—Ç 1: –ü—É—Ç—å –∫ JSON —Ñ–∞–π–ª—É (–ª–æ–∫–∞–ª—å–Ω–∞—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞)
GOOGLE_SERVICE_ACCOUNT_JSON_PATH=/path/to/service-account.json
# –í–∞—Ä–∏–∞–Ω—Ç 2: Base64-encoded JSON (Docker/CI)
GOOGLE_SERVICE_ACCOUNT_JSON_B64=

# Google Drive
DRIVE_FOLDER_ID=1BlVN_L21bhax8aFFVnThDohHLXRpR87Z

# –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –∫–∞—á–µ—Å—Ç–≤–∞ —Ñ–æ—Ç–æ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
PHOTO_MIN_SIZE=800
PHOTO_SHARPNESS_THRESHOLD=100.0
PHOTO_BRIGHTNESS_MIN=40
PHOTO_BRIGHTNESS_MAX=220

# –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
LOG_LEVEL=INFO
TIMEZONE=Europe/Vilnius

# –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
# –°–æ–∑–¥–∞–π—Ç–µ –∞–∫–∫–∞—É–Ω—Ç –Ω–∞ https://sentry.io (–±–µ—Å–ø–ª–∞—Ç–Ω–æ)
SENTRY_DSN=
ENVIRONMENT=production
```

## Google Sheets ‚Äî –°—Ç—Ä—É–∫—Ç—É—Ä–∞ (v1.1)

### –õ–∏—Å—Ç "–°–∫–ª–∞–¥"

–û—Å–Ω–æ–≤–Ω–æ–π –ª–∏—Å—Ç —Å —Ç–æ–≤–∞—Ä–∞–º–∏ (—Ä—É—Å—Å–∫–∏–µ –Ω–∞–∑–≤–∞–Ω–∏—è –∫–æ–ª–æ–Ω–æ–∫):

| –ö–æ–ª–æ–Ω–∫–∞ | –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ | –û–ø–∏—Å–∞–Ω–∏–µ |
|---------|-------------|----------|
| SKU | –î–∞ | –£–Ω–∏–∫–∞–ª—å–Ω—ã–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä —Ç–æ–≤–∞—Ä–∞ |
| –ù–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ | –î–∞ | –ù–∞–∑–≤–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞ |
| –¶–µ–Ω–∞_—Ä—É–± | –î–∞ | –¶–µ–Ω–∞ –≤ —Ä—É–±–ª—è—Ö |
| –°—Ç–∞—Ä—Ç–æ–≤—ã–π_–æ—Å—Ç–∞—Ç–æ–∫ | –î–∞ | –ù–∞—á–∞–ª—å–Ω—ã–π –æ—Å—Ç–∞—Ç–æ–∫ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ |
| –í–Ω–µ—Å–µ–Ω–æ_–≤—Å–µ–≥–æ | –ê–≤—Ç–æ | –§–æ—Ä–º—É–ª–∞ SUMIF –∏–∑ –ª–∏—Å—Ç–∞ –í–Ω–µ—Å–µ–Ω–∏–µ |
| –°–ø–∏—Å–∞–Ω–æ_–≤—Å–µ–≥–æ | –ê–≤—Ç–æ | –§–æ—Ä–º—É–ª–∞ SUMIF –∏–∑ –ª–∏—Å—Ç–∞ –°–ø–∏—Å–∞–Ω–∏–µ |
| –û—Å—Ç–∞—Ç–æ–∫_—Ä–∞—Å—á–µ—Ç | –ê–≤—Ç–æ | –§–æ—Ä–º—É–ª–∞: –°—Ç–∞—Ä—Ç + –í–Ω–µ—Å–µ–Ω–æ - –°–ø–∏—Å–∞–Ω–æ |
| –§–æ—Ç–æ_URL | –î–∞ | URL —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–∏ |
| –ê–∫—Ç–∏–≤–µ–Ω | –î–∞ | TRUE/FALSE (—á–µ–∫–±–æ–∫—Å) |
| –¢–µ–≥–∏ | –ù–µ—Ç | –¢–µ–≥–∏ —á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é |
| –û–ø–∏—Å–∞–Ω–∏–µ_–∫—Ä–∞—Ç–∫–æ | –ù–µ—Ç | –ö—Ä–∞—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ |

### –õ–∏—Å—Ç—ã "–í–Ω–µ—Å–µ–Ω–∏–µ" –∏ "–°–ø–∏—Å–∞–Ω–∏–µ"

**–°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Å –¥–≤—É—Ö—Å—Ç—Ä–æ—á–Ω—ã–º–∏ –∑–∞–≥–æ–ª–æ–≤–∫–∞–º–∏:**
- **Row 1:** –ê–Ω–≥–ª–∏–π—Å–∫–∏–µ –∑–∞–≥–æ–ª–æ–≤–∫–∏ (–¥–ª—è –∫–æ–¥–∞)
- **Row 2:** –†—É—Å—Å–∫–∏–µ –æ–ø–∏—Å–∞–Ω–∏—è (–¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π)
- **Row 3+:** –î–∞–Ω–Ω—ã–µ

**–ö–æ–ª–æ–Ω–∫–∏ (LOG_COLUMNS):**

| # | –ó–∞–≥–æ–ª–æ–≤–æ–∫ | –†—É—Å—Å–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ | –¢–∏–ø |
|---|-----------|------------------|-----|
| A | date | –î–∞—Ç–∞ | ISO datetime |
| B | operation_id | ID –æ–ø–µ—Ä–∞—Ü–∏–∏ | string (UUID) |
| C | sku | –ê—Ä—Ç–∏–∫—É–ª | string |
| D | name | –ù–∞–∑–≤–∞–Ω–∏–µ | string |
| E | qty | –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ | number |
| F | stock_before | –ë—ã–ª–æ –Ω–∞ —Å–∫–ª–∞–¥–µ | number |
| G | stock_after | –°—Ç–∞–ª–æ –Ω–∞ —Å–∫–ª–∞–¥–µ | number |
| H | reason | –ü—Ä–∏—á–∏–Ω–∞ | string |
| I | source | –ò—Å—Ç–æ—á–Ω–∏–∫ | string |
| J | actor_id | ID –∞–∫—Ç–æ—Ä–∞ | number |
| K | actor_username | –ò–º—è –∞–∫—Ç–æ—Ä–∞ | string |
| L | note | –ü—Ä–∏–º–µ—á–∞–Ω–∏–µ | string |

**Self-heal:** –õ–∏—Å—Ç—ã –∏ –∫–æ–ª–æ–Ω–∫–∏ —Å–æ–∑–¥–∞—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏ –ø–µ—Ä–≤–æ–π –∑–∞–ø–∏—Å–∏.

### –ú–∞—Ç—Ä–∏—Ü–∞ –æ–ø–µ—Ä–∞—Ü–∏–π –∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è

| –û–ø–µ—Ä–∞—Ü–∏—è | –õ–∏—Å—Ç "–í–Ω–µ—Å–µ–Ω–∏–µ" | –õ–∏—Å—Ç "–°–ø–∏—Å–∞–Ω–∏–µ" | –ö–æ–ª–æ–Ω–∫–∞ |
|----------|-----------------|-----------------|---------|
| –°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–≥–æ —Ç–æ–≤–∞—Ä–∞ | ‚úÖ `new_product` | - | `–í–Ω–µ—Å–µ–Ω–æ_–≤—Å–µ–≥–æ` |
| –ü—Ä–∏—Ö–æ–¥ –¥–ª—è —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–≥–æ | ‚úÖ `intake` | - | `–í–Ω–µ—Å–µ–Ω–æ_–≤—Å–µ–≥–æ` |
| –ö–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∫–∞ (delta > 0) | ‚úÖ `correction:*` | - | `–í–Ω–µ—Å–µ–Ω–æ_–≤—Å–µ–≥–æ` |
| –ö–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∫–∞ (delta < 0) | - | ‚úÖ `correction:*` | `–°–ø–∏—Å–∞–Ω–æ_–≤—Å–µ–≥–æ` |
| –°–ø–∏—Å–∞–Ω–∏–µ | - | ‚úÖ –ø—Ä–∏—á–∏–Ω–∞ | `–°–ø–∏—Å–∞–Ω–æ_–≤—Å–µ–≥–æ` |
| –ê—Ä—Ö–∏–≤–∞—Ü–∏—è —Å –æ–±–Ω—É–ª–µ–Ω–∏–µ–º | - | ‚úÖ `archive:zero_out` | `–°–ø–∏—Å–∞–Ω–æ_–≤—Å–µ–≥–æ` |

### –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ –∞–ª–∏–∞—Å—ã –∫–æ–ª–æ–Ω–æ–∫

| –ö–æ–¥ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç | –¢–∞–∫–∂–µ –ø—Ä–∏–Ω–∏–º–∞–µ—Ç |
|----------------|-----------------|
| –¶–µ–Ω–∞ | –¶–µ–Ω–∞_—Ä—É–± |
| –û—Å—Ç–∞—Ç–æ–∫ | –û—Å—Ç–∞—Ç–æ–∫_—Ä–∞—Å—á–µ—Ç |
| –§–æ—Ç–æ | –§–æ—Ç–æ_URL |

## Google Drive ‚Äî –ù–∞—Å—Ç—Ä–æ–π–∫–∞

1. –°–æ–∑–¥–∞–π—Ç–µ –ø–∞–ø–∫—É –¥–ª—è —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–π
2. –ü–æ–ª—É—á–∏—Ç–µ ID –ø–∞–ø–∫–∏ –∏–∑ URL
3. –î–∞–π—Ç–µ —Å–µ—Ä–≤–∏—Å–Ω–æ–º—É –∞–∫–∫–∞—É–Ω—Ç—É –ø—Ä–∞–≤–∞ **Editor** –Ω–∞ –ø–∞–ø–∫—É

## –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

- **Whitelist** ‚Äî –¥–æ—Å—Ç—É–ø —Ç–æ–ª—å–∫–æ –ø–æ Telegram ID –∏–∑ `OWNER_TELEGRAM_IDS`
- **–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è** ‚Äî –æ–ø–∞—Å–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—è —Ç—Ä–µ–±—É—é—Ç –ø–æ–≤—Ç–æ—Ä–Ω–æ–≥–æ –Ω–∞–∂–∞—Ç–∏—è (TTL 5 –º–∏–Ω)
- **–ù–∏–∫–∞–∫–∏—Ö secrets –≤ –∫–æ–¥–µ** ‚Äî —Ç–æ–ª—å–∫–æ env –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ

## –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

### Sentry (–æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –æ—à–∏–±–æ–∫)

–ë–µ—Å–ø–ª–∞—Ç–Ω—ã–π –ø–ª–∞–Ω: 10,000 events/month.

1. –°–æ–∑–¥–∞–π—Ç–µ –∞–∫–∫–∞—É–Ω—Ç –Ω–∞ [sentry.io](https://sentry.io)
2. –°–æ–∑–¥–∞–π—Ç–µ Python –ø—Ä–æ–µ–∫—Ç
3. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ DSN –≤ `.env`:

```bash
SENTRY_DSN=https://xxx@xxx.ingest.sentry.io/xxx
ENVIRONMENT=production  # –∏–ª–∏ staging, development
```

### Telegram –∞–ª–µ—Ä—Ç—ã

–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –æ—à–∏–±–∫–∏ –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è –≤—Å–µ–º –≤–ª–∞–¥–µ–ª—å—Ü–∞–º –∏–∑ `OWNER_TELEGRAM_IDS`.

–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤ –∫–æ–¥–µ:
```python
from app.monitoring import alert_owner
await alert_owner(bot, "–û—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ Google Sheets!")
```

### Retry –ª–æ–≥–∏–∫–∞

Google API –≤—ã–∑–æ–≤—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ–≤—Ç–æ—Ä—è—é—Ç—Å—è –ø—Ä–∏ —Å–±–æ—è—Ö (3 –ø–æ–ø—ã—Ç–∫–∏ —Å —ç–∫—Å–ø–æ–Ω–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–º backoff).

–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:
```python
from app.monitoring import google_api_retry

@google_api_retry
async def my_sheets_operation():
    ...
```

### Docker Healthcheck

–ü—Ä–æ–≤–µ—Ä—è–µ—Ç —Ä–µ–∞–ª—å–Ω–æ–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ Google Sheets –∫–∞–∂–¥—ã–µ 60 —Å–µ–∫—É–Ω–¥:

```bash
docker inspect --format='{{.State.Health.Status}}' owner-bot
# healthy / unhealthy
```

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
owner_bot/
‚îú‚îÄ‚îÄ app/
‚îÇ   ‚îú‚îÄ‚îÄ config.py          # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è (Pydantic Settings)
‚îÇ   ‚îú‚îÄ‚îÄ models.py          # Dataclasses
‚îÇ   ‚îú‚îÄ‚îÄ security.py        # Whitelist + ConfirmAction
‚îÇ   ‚îú‚îÄ‚îÄ monitoring.py      # Sentry, –∞–ª–µ—Ä—Ç—ã, retry –ª–æ–≥–∏–∫–∞
‚îÇ   ‚îú‚îÄ‚îÄ sheets.py          # Google Sheets –∫–ª–∏–µ–Ω—Ç
‚îÇ   ‚îú‚îÄ‚îÄ drive.py           # Google Drive –∫–ª–∏–µ–Ω—Ç
‚îÇ   ‚îú‚îÄ‚îÄ cloudinary_client.py  # Cloudinary –¥–ª—è —Ñ–æ—Ç–æ
‚îÇ   ‚îú‚îÄ‚îÄ photo_quality.py   # –ê–Ω–∞–ª–∏–∑ –∫–∞—á–µ—Å—Ç–≤–∞ —Ñ–æ—Ç–æ
‚îÇ   ‚îú‚îÄ‚îÄ photo_enhance.py   # –£–ª—É—á—à–µ–Ω–∏–µ —Ñ–æ—Ç–æ
‚îÇ   ‚îú‚îÄ‚îÄ intake_parser.py   # –ü–∞—Ä—Å–µ—Ä –±—ã—Å—Ç—Ä–æ–π —Å—Ç—Ä–æ–∫–∏
‚îÇ   ‚îú‚îÄ‚îÄ keyboards.py       # Telegram –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã
‚îÇ   ‚îú‚îÄ‚îÄ handlers/          # –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –∫–æ–º–∞–Ω–¥
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ critical.py    # /start, /cancel, /help
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ start.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ intake.py      # FSM –ø—Ä–∏—Ö–æ–¥ —Ç–æ–≤–∞—Ä–∞
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ products.py    # –ü–æ–∏—Å–∫ –∏ –æ–ø–µ—Ä–∞—Ü–∏–∏ —Å —Ç–æ–≤–∞—Ä–∞–º–∏
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ stock.py       # –ü—Ä–æ—Å–º–æ—Ç—Ä —Å–∫–ª–∞–¥–∞ —Å –ø–∞–≥–∏–Ω–∞—Ü–∏–µ–π
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ orders.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ crm.py         # CRM-—Ñ—É–Ω–∫—Ü–∏–∏
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ health.py
‚îÇ   ‚îú‚îÄ‚îÄ services/          # –ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ product_service.py
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ intake_service.py
‚îÇ   ‚îî‚îÄ‚îÄ main.py            # –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞
‚îî‚îÄ‚îÄ tests/                 # –¢–µ—Å—Ç—ã
```

## –¢–µ—Å—Ç—ã

```bash
cd owner_bot
pytest -v
```

## –õ–∏—Ü–µ–Ω–∑–∏—è

MIT
