# üì¶ Telegram –ë–æ—Ç –û–ø—Ç–æ–≤–æ–≥–æ –ú–∞–≥–∞–∑–∏–Ω–∞

## –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

### –û–±–∑–æ—Ä —Å–∏—Å—Ç–µ–º—ã

Telegram-–±–æ—Ç –¥–ª—è –æ–ø—Ç–æ–≤–æ–π —Ç–æ—Ä–≥–æ–≤–ª–∏ —Å –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–µ–π Google Sheets –∏ AI-–∞—Å—Å–∏—Å—Ç–µ–Ω—Ç–æ–º –Ω–∞ –±–∞–∑–µ OpenAI GPT-4o.

---

## üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê     ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê     ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ   Telegram      ‚îÇ‚îÄ‚îÄ‚îÄ‚îÄ‚ñ∂‚îÇ   Bot (Python)  ‚îÇ‚îÄ‚îÄ‚îÄ‚îÄ‚ñ∂‚îÇ  Google Sheets  ‚îÇ
‚îÇ   –ö–ª–∏–µ–Ω—Ç—ã       ‚îÇ‚óÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÇ   aiogram 3.x   ‚îÇ‚óÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÇ   (–°–∫–ª–∞–¥, –ó–∞–∫–∞–∑—ã)‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò     ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò     ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                                 ‚îÇ
                    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
                    ‚ñº            ‚ñº            ‚ñº
              ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
              ‚îÇ SQLite   ‚îÇ ‚îÇ OpenAI   ‚îÇ ‚îÇ PDF      ‚îÇ
              ‚îÇ (–ö–æ—Ä–∑–∏–Ω–∞)‚îÇ ‚îÇ GPT-4o   ‚îÇ ‚îÇ (–°—á–µ—Ç–∞)  ‚îÇ
              ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

---

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
excel-telegram-bot-starter/
‚îú‚îÄ‚îÄ app/
‚îÇ   ‚îú‚îÄ‚îÄ main.py          # –ì–ª–∞–≤–Ω—ã–π —Ñ–∞–π–ª –±–æ—Ç–∞, –≤—Å–µ —Ö–µ–Ω–¥–ª–µ—Ä—ã
‚îÇ   ‚îú‚îÄ‚îÄ config.py        # –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –∏–∑ .env
‚îÇ   ‚îú‚îÄ‚îÄ sheets.py        # –†–∞–±–æ—Ç–∞ —Å Google Sheets API
‚îÇ   ‚îú‚îÄ‚îÄ cart_store.py    # SQLite: –∫–æ—Ä–∑–∏–Ω–∞, –∏—Å—Ç–æ—Ä–∏—è —á–∞—Ç–∞, —Ä–µ–∂–∏–º AI
‚îÇ   ‚îú‚îÄ‚îÄ keyboards.py     # Inline –∏ Reply –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã
‚îÇ   ‚îú‚îÄ‚îÄ ai_manager.py    # OpenAI –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å tool calling
‚îÇ   ‚îú‚îÄ‚îÄ invoice.py       # –ì–µ–Ω–µ—Ä–∞—Ü–∏—è PDF —Å—á–µ—Ç–æ–≤
‚îÇ   ‚îî‚îÄ‚îÄ utils.py         # –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
‚îú‚îÄ‚îÄ docker-compose.yml   # Docker –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
‚îú‚îÄ‚îÄ Dockerfile           # –û–±—Ä–∞–∑ Python 3.11
‚îú‚îÄ‚îÄ requirements.txt     # –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
‚îú‚îÄ‚îÄ .env                 # –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è (–Ω–µ –≤ git!)
‚îî‚îÄ‚îÄ secrets/
    ‚îî‚îÄ‚îÄ service_account.json  # Google —Å–µ—Ä–≤–∏—Å–Ω—ã–π –∞–∫–∫–∞—É–Ω—Ç
```

---

## üîß –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è (.env)

```env
TELEGRAM_BOT_TOKEN=your_telegram_bot_token
GOOGLE_SHEETS_ID=your_google_sheets_id
GOOGLE_SERVICE_ACCOUNT_JSON_PATH=/run/secrets/service_account.json
OPENAI_API_KEY=sk-...
AUTO_WRITE_SPISANIE=true

# (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) –°–î–≠–ö (–≤—ã–±–æ—Ä –ü–í–ó –∫–Ω–æ–ø–∫–∞–º–∏)
# CDEK_CLIENT_ID=...
# CDEK_CLIENT_SECRET=...
# CDEK_TEST_MODE=true
#
# –î–µ–º–æ —Ä–µ–∂–∏–º (–±–µ–∑ —Ä–µ–∞–ª—å–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤). –ï—Å–ª–∏ –≤–∫–ª—é—á—ë–Ω –∏ –Ω–µ—Ç –∫—Ä–µ–¥–æ–≤ ‚Äî –±–æ—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –¥–µ–º–æ-–¥–∞–Ω–Ω—ã–µ:
# CDEK_DEMO_MODE=true
```

---

## üìä –°—Ç—Ä—É–∫—Ç—É—Ä–∞ Google Sheets

### –õ–∏—Å—Ç "–°–∫–ª–∞–¥"
| –ö–æ–ª–æ–Ω–∫–∞ | –û–ø–∏—Å–∞–Ω–∏–µ |
|---------|----------|
| SKU | –£–Ω–∏–∫–∞–ª—å–Ω—ã–π –∞—Ä—Ç–∏–∫—É–ª —Ç–æ–≤–∞—Ä–∞ (PRD-001) |
| –ù–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ | –ù–∞–∑–≤–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞ |
| –û–ø–∏—Å–∞–Ω–∏–µ_–∫—Ä–∞—Ç–∫–æ | –ö—Ä–∞—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ |
| –¶–µ–Ω–∞_—Ä—É–± | –¶–µ–Ω–∞ –≤ —Ä—É–±–ª—è—Ö |
| –°—Ç–∞—Ä—Ç–æ–≤—ã–π_–æ—Å—Ç–∞—Ç–æ–∫ | –ù–∞—á–∞–ª—å–Ω—ã–π –æ—Å—Ç–∞—Ç–æ–∫ |
| –°–ø–∏—Å–∞–Ω–æ_–≤—Å–µ–≥–æ | –°–ø–∏—Å–∞–Ω–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ |
| –û—Å—Ç–∞—Ç–æ–∫_—Ä–∞—Å—á–µ—Ç | –§–æ—Ä–º—É–ª–∞: =–°—Ç–∞—Ä—Ç–æ–≤—ã–π - –°–ø–∏—Å–∞–Ω–æ |
| –§–æ—Ç–æ_URL | –°—Å—ã–ª–∫–∞ –Ω–∞ —Ñ–æ—Ç–æ (Google Drive) |
| –ê–∫—Ç–∏–≤–µ–Ω | "–¥–∞" –¥–ª—è –∞–∫—Ç–∏–≤–Ω—ã—Ö —Ç–æ–≤–∞—Ä–æ–≤ |
| –¢–µ–≥–∏ | –ö–∞—Ç–µ–≥–æ—Ä–∏–∏ —á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é |

### –õ–∏—Å—Ç "–ó–∞–∫–∞–∑—ã"
| –ö–æ–ª–æ–Ω–∫–∞ | –û–ø–∏—Å–∞–Ω–∏–µ |
|---------|----------|
| ID | –ù–æ–º–µ—Ä –∑–∞–∫–∞–∑–∞ (ORD-XXXXX) |
| –î–∞—Ç–∞ | –î–∞—Ç–∞ –∏ –≤—Ä–µ–º—è –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—è |
| User_ID | Telegram ID –ø–æ–∫—É–ø–∞—Ç–µ–ª—è |
| –¢–µ–ª–µ—Ñ–æ–Ω | –ö–æ–Ω—Ç–∞–∫—Ç–Ω—ã–π —Ç–µ–ª–µ—Ñ–æ–Ω |
| –°—Ç–∞—Ç—É—Å | "–°—á–µ—Ç –≤—ã—Å—Ç–∞–≤–ª–µ–Ω" |
| –°—É–º–º–∞ | –ò—Ç–æ–≥–æ–≤–∞—è —Å—É–º–º–∞ –∑–∞–∫–∞–∑–∞ |
| –î–æ—Å—Ç–∞–≤–∫–∞ | –°–î–≠–ö / –ü–í–ó |
| –ê–¥—Ä–µ—Å | –ê–¥—Ä–µ—Å –¥–æ—Å—Ç–∞–≤–∫–∏ |
| –ü–æ–∑–∏—Ü–∏–∏ | SKU:qty —á–µ—Ä–µ–∑ ; |
| –§–∞–π–ª | –ò–º—è PDF —Å—á–µ—Ç–∞ |

### –õ–∏—Å—Ç "–°–ø–∏—Å–∞–Ω–∏–µ"
| –ö–æ–ª–æ–Ω–∫–∞ | –û–ø–∏—Å–∞–Ω–∏–µ |
|---------|----------|
| –î–∞—Ç–∞ | –î–∞—Ç–∞ —Å–ø–∏—Å–∞–Ω–∏—è |
| SKU | –ê—Ä—Ç–∏–∫—É–ª —Ç–æ–≤–∞—Ä–∞ |
| –ö–æ–ª-–≤–æ | –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–ø–∏—Å–∞–Ω–æ |
| ‚Ññ —Å—á–µ—Ç–∞ | –ù–æ–º–µ—Ä —Å—á–µ—Ç–∞ |
| ID –∑–∞–∫–∞–∑–∞ | ID –∑–∞–∫–∞–∑–∞ |
| –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π | "–ê–≤—Ç–æ-—Å–ø–∏—Å–∞–Ω–∏–µ –ø–æ—Å–ª–µ —Å—á–µ—Ç–∞" |

### –õ–∏—Å—Ç "–ù–∞—Å—Ç—Ä–æ–π–∫–∏"
| –ö–ª—é—á | –ó–Ω–∞—á–µ–Ω–∏–µ |
|------|----------|
| –ú–∏–Ω. —Å—É–º–º–∞ –∑–∞–∫–∞–∑–∞ | 5000 |
| –ö–æ–º–ø–∞–Ω–∏—è | –û–û–û "–í–∞—à–∞ –∫–æ–º–ø–∞–Ω–∏—è" |
| –ò–ù–ù | 1234567890 |
| ... | ... |

---

## ü§ñ AI-–∞—Å—Å–∏—Å—Ç–µ–Ω—Ç

### –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏
- –ü–æ–Ω–∏–º–∞–µ—Ç –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω—É—é —Ä–µ—á—å ("–¥–æ–±–∞–≤—å 5 –∑–æ–ª–æ—Ç–æ–π")
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –Ω–∞—Ö–æ–¥–∏—Ç —Ç–æ–≤–∞—Ä—ã –ø–æ —á–∞—Å—Ç–∏—á–Ω—ã–º –Ω–∞–∑–≤–∞–Ω–∏—è–º
- –î–æ–±–∞–≤–ª—è–µ—Ç —Ç–æ–≤–∞—Ä—ã –≤ –∫–æ—Ä–∑–∏–Ω—É
- –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞–ª–∏—á–∏–µ –∏ —Ü–µ–Ω—ã
- –ü–æ–º–æ–≥–∞–µ—Ç –æ—Ñ–æ—Ä–º–∏—Ç—å –∑–∞–∫–∞–∑

### –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã (Tools)
| Tool | –û–ø–∏—Å–∞–Ω–∏–µ |
|------|----------|
| `list_all_products` | –ü–æ–ª—É—á–∏—Ç—å –≤–µ—Å—å –∫–∞—Ç–∞–ª–æ–≥ —Å SKU |
| `search_products` | –ü–æ–∏—Å–∫ –ø–æ –Ω–∞–∑–≤–∞–Ω–∏—é/—Ç–µ–≥–∞–º |
| `add_to_cart` | –î–æ–±–∞–≤–∏—Ç—å —Ç–æ–≤–∞—Ä –≤ –∫–æ—Ä–∑–∏–Ω—É |
| `show_cart` | –ü–æ–∫–∞–∑–∞—Ç—å —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –∫–æ—Ä–∑–∏–Ω—ã |
| `checkout_hint` | –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—é |

### –ú–æ–¥–µ–ª—å
- GPT-4o (–Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç—Å—è –≤ config.py)
- –ò—Å—Ç–æ—Ä–∏—è –¥–∏–∞–ª–æ–≥–∞: –ø–æ—Å–ª–µ–¥–Ω–∏–µ 20 —Å–æ–æ–±—â–µ–Ω–∏–π

---

## üóÇÔ∏è SQLite –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö

–ü—É—Ç—å: `/app/data/bot.sqlite3`

### –¢–∞–±–ª–∏—Ü—ã
```sql
-- –ö–æ—Ä–∑–∏–Ω–∞
CREATE TABLE cart_items (
    user_id INTEGER NOT NULL,
    sku TEXT NOT NULL,
    qty INTEGER NOT NULL,
    PRIMARY KEY (user_id, sku)
);

-- –†–µ–∂–∏–º AI
CREATE TABLE user_mode (
    user_id INTEGER PRIMARY KEY,
    ai_mode INTEGER NOT NULL DEFAULT 0
);

-- –ò—Å—Ç–æ—Ä–∏—è —á–∞—Ç–∞ (–¥–ª—è AI –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞)
CREATE TABLE chat_history (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    user_id INTEGER NOT NULL,
    role TEXT NOT NULL,
    content TEXT NOT NULL,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

-- CRM —Å–æ–±—ã—Ç–∏—è (Phase 1)
CREATE TABLE crm_events (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    user_id INTEGER NOT NULL,
    event_type TEXT NOT NULL,
    payload_json TEXT,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

-- CRM —Å–æ–æ–±—â–µ–Ω–∏—è (Phase 3)
CREATE TABLE crm_messages (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    user_id INTEGER NOT NULL,
    direction TEXT NOT NULL,      -- 'in' –∏–ª–∏ 'out'
    message_type TEXT NOT NULL,   -- 'text', 'ai_response', etc.
    text TEXT NOT NULL,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);
```

---

## üìä CRM –°–∏—Å—Ç–µ–º–∞ (v1.1-v1.3)

### –û–±–∑–æ—Ä
CRM-–º–æ–¥—É–ª—å –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –∫–ª–∏–µ–Ω—Ç–æ–≤ —á–µ—Ä–µ–∑ –≤–æ—Ä–æ–Ω–∫—É –ø—Ä–æ–¥–∞–∂ —Å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ–º —Å–æ–±—ã—Ç–∏–π –∏ —Å–æ–æ–±—â–µ–Ω–∏–π.

### –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞
```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê     ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê     ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ   Shop Bot      ‚îÇ‚îÄ‚îÄ‚îÄ‚îÄ‚ñ∂‚îÇ   SQLite        ‚îÇ‚îÄ‚îÄ‚îÄ‚îÄ‚ñ∂‚îÇ   Owner Bot     ‚îÇ
‚îÇ   (–ö–ª–∏–µ–Ω—Ç—ã)     ‚îÇ     ‚îÇ   (–°–æ–±—ã—Ç–∏—è,     ‚îÇ     ‚îÇ   (CRM –º–µ–Ω—é)    ‚îÇ
‚îÇ                 ‚îÇ     ‚îÇ    –°–æ–æ–±—â–µ–Ω–∏—è)   ‚îÇ     ‚îÇ                 ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò     ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò     ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
         ‚îÇ                                               ‚îÇ
         ‚ñº                                               ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê                           ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  Google Sheets  ‚îÇ                           ‚îÇ  OpenAI GPT     ‚îÇ
‚îÇ  (–õ–∏–¥—ã)         ‚îÇ                           ‚îÇ  (AI-—Å–≤–æ–¥–∫–∏)    ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò                           ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### –í–æ—Ä–æ–Ω–∫–∞ –ø—Ä–æ–¥–∞–∂ (6 —Å—Ç–∞–¥–∏–π)
```
üÜï new ‚Üí üëÄ engaged ‚Üí üõí cart ‚Üí üìù checkout ‚Üí ‚úÖ customer ‚Üí üåü repeat
```

**–ü—Ä–∞–≤–∏–ª–æ:** —Å—Ç–∞–¥–∏—è —Ç–æ–ª—å–∫–æ –ø–æ–≤—ã—à–∞–µ—Ç—Å—è, –Ω–∏–∫–æ–≥–¥–∞ –Ω–µ –ø–æ–Ω–∏–∂–∞–µ—Ç—Å—è.

### –°–æ–±—ã—Ç–∏—è CRM
| –°–æ–±—ã—Ç–∏–µ | –°—Ç–∞–¥–∏—è | –û–ø–∏—Å–∞–Ω–∏–µ |
|---------|--------|----------|
| `start` | new | –ü–µ—Ä–≤—ã–π /start |
| `catalog_view` | engaged | –ü—Ä–æ—Å–º–æ—Ç—Ä –∫–∞—Ç–∞–ª–æ–≥–∞ |
| `product_view` | engaged | –ü—Ä–æ—Å–º–æ—Ç—Ä —Ç–æ–≤–∞—Ä–∞ |
| `search` | engaged | –ü–æ–∏—Å–∫ |
| `add_to_cart` | cart | –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –≤ –∫–æ—Ä–∑–∏–Ω—É |
| `checkout_started` | checkout | –ù–∞—á–∞–ª–æ –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—è |
| `order_created` | customer/repeat | –ó–∞–∫–∞–∑ –æ—Ñ–æ—Ä–º–ª–µ–Ω |

### Google Sheets: –õ–∏—Å—Ç "Leads"
| –ö–æ–ª–æ–Ω–∫–∞ | –û–ø–∏—Å–∞–Ω–∏–µ |
|---------|----------|
| user_id | Telegram ID |
| username | @username |
| first_seen_at | –ü–µ—Ä–≤—ã–π –≤–∏–∑–∏—Ç |
| last_seen_at | –ü–æ—Å–ª–µ–¥–Ω–∏–π –≤–∏–∑–∏—Ç |
| stage | –¢–µ–∫—É—â–∞—è —Å—Ç–∞–¥–∏—è |
| orders_count | –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–∫–∞–∑–æ–≤ |
| lifetime_value | –°—É–º–º–∞ –≤—Å–µ—Ö –∑–∞–∫–∞–∑–æ–≤ |
| consent_at | –î–∞—Ç–∞ —Å–æ–≥–ª–∞—Å–∏—è |
| phone | –¢–µ–ª–µ—Ñ–æ–Ω |
| tags | –ú–µ—Ç–∫–∏ (vip, problem, etc) |
| notes | –ó–∞–º–µ—Ç–∫–∏ –º–µ–Ω–µ–¥–∂–µ—Ä–∞ |

### Owner Bot: CRM –º–µ–Ω—é
- üìà **–í–æ—Ä–æ–Ω–∫–∞** ‚Äî –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è —Å –∫–æ–Ω–≤–µ—Ä—Å–∏—è–º–∏
- üë• **–ü–æ—Å–ª–µ–¥–Ω–∏–µ –ª–∏–¥—ã** ‚Äî —Å–ø–∏—Å–æ–∫ –∫–ª–∏–µ–Ω—Ç–æ–≤
- üîç **–ü–æ–∏—Å–∫ –∫–ª–∏–µ–Ω—Ç–∞** ‚Äî –ø–æ ID/—Ç–µ–ª–µ—Ñ–æ–Ω—É/–∏–º–µ–Ω–∏
- üìã **–û—Ç—á—ë—Ç –∑–∞ –¥–µ–Ω—å** ‚Äî —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
- üë§ **–ö–∞—Ä—Ç–æ—á–∫–∞ –∫–ª–∏–µ–Ω—Ç–∞** ‚Äî –¥–µ—Ç–∞–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è
  - üìù –ó–∞–º–µ—Ç–∫–∞ ‚Äî –¥–æ–±–∞–≤–∏—Ç—å –∑–∞–º–µ—Ç–∫—É
  - üè∑ –¢–µ–≥–∏ ‚Äî —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –º–µ—Ç–∫–∞–º–∏
  - üìú –ò—Å—Ç–æ—Ä–∏—è ‚Äî –ø—Ä–æ—Å–º–æ—Ç—Ä –ø–µ—Ä–µ–ø–∏—Å–∫–∏
  - üß† AI-—Å–≤–æ–¥–∫–∞ ‚Äî –∞–Ω–∞–ª–∏–∑ –¥–∏–∞–ª–æ–≥–∞ —á–µ—Ä–µ–∑ GPT

---

## üöÄ –ó–∞–ø—É—Å–∫

### Docker (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
```bash
# –°–±–æ—Ä–∫–∞ –∏ –∑–∞–ø—É—Å–∫
docker compose up --build -d

# –õ–æ–≥–∏
docker compose logs -f bot

# –û—Å—Ç–∞–Ω–æ–≤–∫–∞
docker compose down
```

### –õ–æ–∫–∞–ª—å–Ω–æ
```bash
pip install -r requirements.txt
python -m app.main
```

---

## üì± –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å –±–æ—Ç–∞

### –ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é (–ø–æ—Å—Ç–æ—è–Ω–Ω—ã–µ –∫–Ω–æ–ø–∫–∏)
- üóÇ –ö–∞—Ç–∞–ª–æ–≥ ‚Äî –ª–∏—Å—Ç–∞—Ç—å —Ç–æ–≤–∞—Ä—ã —Å —Ñ–æ—Ç–æ
- üß∫ –ö–æ—Ä–∑–∏–Ω–∞ ‚Äî –ø—Ä–æ—Å–º–æ—Ç—Ä –∏ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
- ü§ñ AI –ú–µ–Ω–µ–¥–∂–µ—Ä ‚Äî –∞–∫—Ç–∏–≤–µ–Ω –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
- üìã –ú–µ–Ω—é ‚Äî –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –æ–ø—Ü–∏–∏

### –ö–∞—Ç–∞–ª–æ–≥
- –§–æ—Ç–æ-–∫–∞—Ä—Ç–æ—á–∫–∏ —Ç–æ–≤–∞—Ä–æ–≤
- –ù–∞–≤–∏–≥–∞—Ü–∏—è ‚óÄÔ∏è / ‚ñ∂Ô∏è
- –ö–Ω–æ–ø–∫–∞ "–í –∫–æ—Ä–∑–∏–Ω—É"
- –ü–æ–∫–∞–∑ —Ü–µ–Ω—ã –∏ –æ—Å—Ç–∞—Ç–∫–∞

### –ö–æ—Ä–∑–∏–Ω–∞
- –°–ø–∏—Å–æ–∫ —Ç–æ–≤–∞—Ä–æ–≤ —Å —Ü–µ–Ω–∞–º–∏
- ‚ûï / ‚ûñ –∫–Ω–æ–ø–∫–∏ –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞
- üóë –£–¥–∞–ª–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞
- –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —Å—É–º–º–∞ –∑–∞–∫–∞–∑–∞

### –û—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ –∑–∞–∫–∞–∑–∞
1. –í–≤–æ–¥ —Ç–µ–ª–µ—Ñ–æ–Ω–∞
2. –í–≤–æ–¥ –∞–¥—Ä–µ—Å–∞ –¥–æ—Å—Ç–∞–≤–∫–∏
3. –ì–µ–Ω–µ—Ä–∞—Ü–∏—è PDF —Å—á–µ—Ç–∞
4. –ó–∞–ø–∏—Å—å –≤ Google Sheets
5. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–ø–∏—Å–∞–Ω–∏–µ —Å–æ —Å–∫–ª–∞–¥–∞

---

## üîÑ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–ø–∏—Å–∞–Ω–∏–µ

–ü—Ä–∏ –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏–∏ –∑–∞–∫–∞–∑–∞ (–µ—Å–ª–∏ `AUTO_WRITE_SPISANIE=true`):
1. –ó–∞–ø–∏—Å—å –≤ –ª–∏—Å—Ç "–°–ø–∏—Å–∞–Ω–∏–µ"
2. –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–æ–ª–æ–Ω–∫–∏ "–°–ø–∏—Å–∞–Ω–æ_–≤—Å–µ–≥–æ" –≤ –ª–∏—Å—Ç–µ "–°–∫–ª–∞–¥"
3. –û—Å—Ç–∞—Ç–æ–∫ –ø–µ—Ä–µ—Å—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏

---

## üñºÔ∏è –§–æ—Ç–æ —Ç–æ–≤–∞—Ä–æ–≤

–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã URL:
- Google Drive: –∞–≤—Ç–æ–∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è `/file/d/.../view` ‚Üí `/uc?export=view&id=...`
- Dropbox: –∑–∞–º–µ–Ω–∞ `dl=0` –Ω–∞ `dl=1`
- –ü—Ä—è–º—ã–µ —Å—Å—ã–ª–∫–∏ –Ω–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è

---

## üìù –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

–û—Ç–ª–∞–¥–æ—á–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è:
```
[DEBUG] any_text called, text=...
[DEBUG] ai_mode=True
[AI DEBUG] Sending request to gpt-4o with N messages
[AI DEBUG] Tool call: add_to_cart({"sku": "PRD-001", "qty": 5})
```

---

## üõ†Ô∏è –ß–∞—Å—Ç—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

### –ö–æ—Ä–∑–∏–Ω–∞ –ø—É—Å—Ç–∞ –ø–æ—Å–ª–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è —á–µ—Ä–µ–∑ AI
- –û—á–∏—Å—Ç–∏—Ç–µ –∏—Å—Ç–æ—Ä–∏—é —á–∞—Ç–∞: `DELETE FROM chat_history`
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ AI –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ SKU

### –§–æ—Ç–æ –Ω–µ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ —Ñ–∞–π–ª –≤ Google Drive –¥–æ—Å—Ç—É–ø–µ–Ω "–î–ª—è –≤—Å–µ—Ö –ø–æ —Å—Å—ã–ª–∫–µ"

### AI –Ω–µ –æ—Ç–≤–µ—á–∞–µ—Ç
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ `OPENAI_API_KEY` –≤ `.env`
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –Ω–∞ –æ—à–∏–±–∫–∏

---

## üì¶ –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

```
aiogram==3.6.0          # Telegram Bot API
pydantic==2.7.4         # –í–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö
aiosqlite==0.20.0       # Async SQLite
google-api-python-client # Google Sheets API
openai>=1.50.0          # OpenAI GPT
reportlab==4.2.2        # PDF –≥–µ–Ω–µ—Ä–∞—Ü–∏—è
```

---

## üìÑ –õ–∏—Ü–µ–Ω–∑–∏—è

MIT License
